{% extends 'base.html' %}
{% block content %}
<div>
    <h1>Profile of {{ user.username }}</h1>

    {% if profile %}
    <div>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Phone:</strong> {{ profile.phone }}</p>
        <p><strong>Address:</strong> {{ profile.address }}</p>
        <p><strong>Favorite Brand:</strong> {{ profile.favorite_brand }}</p>
    </div>
    {% else %}
    <p>No profile data found.</p>
    {% endif %}

    <!-- User's Cars -->
    <div>
        <h2>{{ user.username }}'s Cars</h2>
        {% if cars %}
            <div>
                {% for car in cars %}
                <div>
                    {% if car.image_set.first %}
                        <img src="{{ car.image_set.first.image.url }}" alt="Car Image">
                    {% endif %}
                    <p><strong>Brand:</strong> {{ car.brand }}</p>
                    <p><strong>Model:</strong> {{ car.model }}</p>
                    <p><strong>Year:</strong> {{ car.year }}</p>

                    <!-- Show edit/delete only if it's the logged-in user's own car -->
                    {% if request.user == car.owner %}
                        <a href="{% url 'edit_car' car.id %}"">Edit</a>
                        <form method="post" action="{% url 'delete_car' car.id %}">
                            {% csrf_token %}
                            <button type="submit">Delete</button>
                        </form>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No cars listed.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
